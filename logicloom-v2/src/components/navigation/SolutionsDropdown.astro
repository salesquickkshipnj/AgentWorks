---
import { Icon } from 'astro-icon/components';

// THE 3 CORE ARCHITECTURES
const architectures = [
  { 
    name: "The Growth Engine", 
    desc: "Automated Lead Capture & Outreach.", 
    icon: "ph:rocket-launch", 
    href: "/case-studies#growth-engine", // Links to the grouped section
    color: "text-blue-600",
    bg: "bg-blue-50"
  },
  { 
    name: "Operations Autopilot", 
    desc: "Fulfillment & Logistics Logic.", 
    icon: "ph:gear-six", 
    href: "/case-studies#ops-autopilot",
    color: "text-orange-600",
    bg: "bg-orange-50"
  },
  { 
    name: "Service Concierge", 
    desc: "AI Support & Retention Agents.", 
    icon: "ph:brain", 
    href: "/case-studies#service-concierge",
    color: "text-purple-600",
    bg: "bg-purple-50"
  }
];

const capabilities = [
  {
    name: "n8n Workflow Design",
    desc: "Visual logic mapping.",
    icon: "ph:tree-structure",
    href: "/n8n-services",
  },
  {
    name: "API Integration",
    desc: "Custom Python/JS wrappers.",
    icon: "ph:plugs-connected",
    href: "/integrations",
  },
  {
    name: "Database Orchestration",
    desc: "SQL / Airtable syncs.",
    icon: "ph:database",
    href: "/data-services",
  }
];
---

<div 
  x-data="{ open: false }" 
  @click.outside="open = false" 
  @mouseleave="open = false"
  class="relative"
>
  
  <button 
    @mouseover="open = true"
    class="flex items-center gap-1 text-sm font-medium text-gray-600 hover:text-slate-900 transition-colors group h-16"
    :class="open ? 'text-slate-900' : ''"
  >
    <span>Solutions</span>
    <Icon 
      name="ph:caret-down" 
      class="text-xs text-gray-400 group-hover:text-slate-900 transition-transform duration-200" 
      :class="open ? 'rotate-180' : ''" 
    />
  </button>

  <div 
    x-show="open" 
    x-transition:enter="transition ease-out duration-200"
    x-transition:enter-start="opacity-0 translate-y-2"
    x-transition:enter-end="opacity-100 translate-y-0"
    x-transition:leave="transition ease-in duration-150"
    x-transition:leave-start="opacity-100 translate-y-0"
    x-transition:leave-end="opacity-0 translate-y-2"
    style="display: none;"
    class="absolute top-full left-1/2 -translate-x-1/2 w-[600px] bg-white rounded-2xl shadow-xl shadow-slate-200/50 border border-gray-100 overflow-hidden z-50 ring-1 ring-black/5"
  >
    
    <div class="p-2">
      <div class="grid grid-cols-1 gap-2 p-2">
          <span class="text-[10px] font-bold text-gray-400 uppercase tracking-widest px-2 mt-2 mb-1">Core Architectures</span>
          
          {architectures.map((item) => (
            <a href={item.href} class="flex items-start gap-4 p-3 rounded-xl hover:bg-gray-50 transition-colors group">
              <div class={`w-10 h-10 rounded-lg flex items-center justify-center shrink-0 ${item.bg} ${item.color} group-hover:scale-110 transition-transform duration-200`}>
                <Icon name={item.icon} class="w-6 h-6" />
              </div>
              <div>
                <h3 class="font-bold text-slate-900 text-sm leading-tight mb-1 group-hover:text-blue-600 transition-colors">{item.name}</h3>
                <p class="text-xs text-gray-500 leading-snug">{item.desc}</p>
              </div>
            </a>
          ))}
      </div>

      <div class="bg-slate-50 rounded-xl p-4 mt-2 border border-gray-100 flex items-center justify-between">
          <div>
            <h4 class="text-sm font-bold text-slate-900">Custom Implementation?</h4>
            <p class="text-xs text-gray-500">We audit your stack before we build.</p>
          </div>
          <a href="/audit" class="text-xs font-bold bg-slate-900 text-white px-4 py-2 rounded-lg hover:bg-slate-800 transition-colors">
            Start Audit
          </a>
      </div>
    </div>

  </div>
</div>