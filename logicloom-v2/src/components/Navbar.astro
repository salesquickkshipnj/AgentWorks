---
import { Icon } from 'astro-icon/components';
---

<header
  id="main-header"
  class="fixed w-full z-50 top-0 transition-all duration-300 border-b border-transparent"
  x-data="{ mobileMenuOpen: false, solutionsOpen: false }"
>
  <div class="max-w-7xl mx-auto px-6 h-16 flex items-center justify-between">
    
    <a href="/" aria-label="LogicLoom Systems Home" class="group focus:outline-none">
        <div class="relative w-auto h-10">
           <svg viewBox="0 0 600 200" fill="none" xmlns="http://www.w3.org/2000/svg" class="h-full w-auto">
              <g stroke="#94A3B8" stroke-width="2" stroke-opacity="0.5" fill="none" stroke-linecap="round">
                <path d="M50 135 L80 143 L110 157 L140 165 L170 158 L200 144" />
                <path d="M50 102 L80 110 L110 124 L140 132 L170 125 L200 111" />
                <path d="M50 69 L80 77 L110 91 L140 99 L170 92 L200 78" />
                <path d="M50 36 L80 44 L110 58 L140 66 L170 59 L200 45" />
                <path d="M50 135 L50 36" />
                <path d="M80 143 L80 44" />
                <path d="M110 157 L110 58" />
                <path d="M140 165 L140 66" />
                <path d="M170 158 L170 59" />
                <path d="M200 144 L200 45" />
              </g>
              <g fill="#1E293B"> <circle cx="50" cy="135" r="5" /> <circle cx="50" cy="102" r="5" /> <circle cx="50" cy="69" r="5" /> <circle cx="50" cy="36" r="5" /> </g>
              <g fill="#18375C"> <circle cx="80" cy="143" r="5" /> <circle cx="80" cy="110" r="5" /> <circle cx="80" cy="77" r="5" /> <circle cx="80" cy="44" r="5" /> </g>
              <g fill="#12467D"> <circle cx="110" cy="157" r="5" /> <circle cx="110" cy="124" r="5" /> <circle cx="110" cy="91" r="5" /> <circle cx="110" cy="58" r="5" /> </g>
              <g fill="#0C549F"> <circle cx="140" cy="165" r="5" /> <circle cx="140" cy="132" r="5" /> <circle cx="140" cy="99" r="5" /> <circle cx="140" cy="66" r="5" /> </g>
              <g fill="#0663C0"> <circle cx="170" cy="158" r="5" /> <circle cx="170" cy="125" r="5" /> <circle cx="170" cy="92" r="5" /> <circle cx="170" cy="59" r="5" /> </g>
              <g fill="#0071E3"> <circle cx="200" cy="144" r="5" /> <circle cx="200" cy="111" r="5" /> <circle cx="200" cy="78" r="5" /> <circle cx="200" cy="45" r="5" /> </g>
              <text x="230" y="107" font-family="'Space Grotesk', sans-serif" font-weight="bold" font-size="60" fill="#1E293B">LogicLoom</text>
              <text x="232" y="144" font-family="'Space Grotesk', sans-serif" font-weight="500" font-size="30" letter-spacing="1.5" fill="#64748B">SYSTEMS</text>
              <line x1="232" y1="152" x2="350" y2="152" stroke="#0071E3" stroke-width="2" />
           </svg>
        </div>
    </a>

    <nav class="hidden md:flex items-center gap-6">
      
      <a href="#capabilities" class="text-sm font-medium text-gray-600 hover:text-indigo-600 transition-colors">Capabilities</a>
      <a href="#process" class="text-sm font-medium text-gray-600 hover:text-indigo-600 transition-colors">Process</a>

      <div class="relative" @click.outside="solutionsOpen = false">
        <button 
            @click="solutionsOpen = !solutionsOpen" 
            class="flex items-center gap-1 text-sm font-medium text-gray-600 hover:text-indigo-600 transition-colors group"
        >
            Solutions 
            <Icon name="ph:caret-down" class="text-xs text-gray-400 group-hover:text-indigo-600 transition-colors" :class="{'rotate-180': solutionsOpen}" />
        </button>

        <div 
            x-show="solutionsOpen" 
            x-transition:enter="transition ease-out duration-200"
            x-transition:enter-start="opacity-0 translate-y-2"
            x-transition:enter-end="opacity-100 translate-y-0"
            style="display: none;"
            class="absolute top-full left-1/2 -translate-x-1/2 mt-6 w-[600px] bg-white rounded-2xl shadow-xl border border-gray-100 overflow-hidden p-6 grid grid-cols-2 gap-8"
        >
            <div>
                <span class="text-xs font-bold text-gray-500 uppercase tracking-widest mb-4 block">By Industry</span>
                <div class="space-y-2">
                    <a href="/industries/roofing-automation" class="flex items-center gap-3 p-2 rounded-lg hover:bg-gray-50 transition-colors group">
                        <div class="w-8 h-8 rounded-lg bg-orange-50 text-orange-600 flex items-center justify-center">
                            <Icon name="ph:house-line" class="w-5 h-5" />
                        </div>
                        <div><p class="text-sm font-bold text-slate-900">Roofing & Trades</p></div>
                    </a>
                    <a href="/industries/dental-automation" class="flex items-center gap-3 p-2 rounded-lg hover:bg-gray-50 transition-colors group">
                        <div class="w-8 h-8 rounded-lg bg-teal-50 text-teal-600 flex items-center justify-center">
                            <Icon name="ph:tooth" class="w-5 h-5" />
                        </div>
                        <div><p class="text-sm font-bold text-slate-900">Dental Practices</p></div>
                    </a>
                    <a href="/industries/real-estate-ai" class="flex items-center gap-3 p-2 rounded-lg hover:bg-gray-50 transition-colors group">
                        <div class="w-8 h-8 rounded-lg bg-emerald-50 text-emerald-600 flex items-center justify-center">
                            <Icon name="ph:buildings" class="w-5 h-5" />
                        </div>
                        <div><p class="text-sm font-bold text-slate-900">Real Estate</p></div>
                    </a>
                    <a href="/industries/legal-automation" class="flex items-center gap-3 p-2 rounded-lg hover:bg-gray-50 transition-colors group">
                        <div class="w-8 h-8 rounded-lg bg-amber-50 text-amber-600 flex items-center justify-center">
                            <Icon name="ph:gavel" class="w-5 h-5" />
                        </div>
                        <div><p class="text-sm font-bold text-slate-900">Law Firms</p></div>
                    </a>
                </div>
            </div>

            <div>
                <span class="text-xs font-bold text-gray-500 uppercase tracking-widest mb-4 block">By Workflow</span>
                <div class="space-y-2">
                    <a href="/use-cases/lead-to-crm" class="flex items-center gap-3 p-2 rounded-lg hover:bg-gray-50 transition-colors group">
                        <div class="w-8 h-8 rounded-lg bg-indigo-50 text-indigo-600 flex items-center justify-center">
                            <Icon name="ph:lightning" class="w-5 h-5" />
                        </div>
                        <div><p class="text-sm font-bold text-slate-900">Lead-to-CRM</p></div>
                    </a>
                    <a href="/use-cases/inbox-triage" class="flex items-center gap-3 p-2 rounded-lg hover:bg-gray-50 transition-colors group">
                        <div class="w-8 h-8 rounded-lg bg-sky-50 text-sky-600 flex items-center justify-center">
                            <Icon name="ph:envelope-open" class="w-5 h-5" />
                        </div>
                        <div><p class="text-sm font-bold text-slate-900">Inbox Triage</p></div>
                    </a>
                    <a href="/migrations/zapier-to-n8n" class="flex items-center gap-3 p-2 rounded-lg hover:bg-gray-50 transition-colors group">
                        <div class="w-8 h-8 rounded-lg bg-orange-50 text-orange-600 flex items-center justify-center">
                            <Icon name="ph:arrows-merge" class="w-5 h-5" />
                        </div>
                        <div><p class="text-sm font-bold text-slate-900">Zapier Migration</p></div>
                    </a>
                </div>
            </div>
        </div>
      </div>
      <a href="#pricing" class="text-sm font-medium text-gray-600 hover:text-indigo-600 transition-colors">Pricing</a>
    </nav>

    <div class="hidden md:flex items-center gap-4">
      <a href="/n8n-services" class="text-sm font-medium text-gray-500 hover:text-slate-900">n8n Experts</a>
      <button 
        @click="$dispatch('open-modal')"
        class="text-sm font-semibold bg-slate-900 text-white px-5 py-2.5 rounded-full hover:bg-slate-800 transition-colors shadow-lg shadow-slate-900/20 active:scale-95"
      >
        Book Audit
      </button>
    </div>

    <button @click="mobileMenuOpen = !mobileMenuOpen" class="md:hidden text-slate-900 p-2">
        <Icon name="ph:list" class="text-2xl" />
    </button>
  </div>

  <div 
      x-show="mobileMenuOpen" 
      style="display: none;"
      x-transition
      class="absolute top-16 left-0 w-full bg-white border-b border-gray-200 p-6 md:hidden shadow-xl h-[85vh] overflow-y-auto" 
      @click.outside="mobileMenuOpen = false"
  >
       <div class="space-y-6">
            <div class="space-y-4 pb-4 border-b border-gray-100">
                <a href="#capabilities" @click="mobileMenuOpen = false" class="block text-lg font-bold text-slate-900">Capabilities</a>
                <a href="#process" @click="mobileMenuOpen = false" class="block text-lg font-bold text-slate-900">The Protocol</a>
                <a href="#pricing" @click="mobileMenuOpen = false" class="block text-lg font-bold text-slate-900">Pricing</a>
            </div>

            <div>
                <span class="text-xs font-bold text-gray-500 uppercase tracking-widest mb-3 block">Industries</span>
                <div class="space-y-3 pl-2">
                    <a href="/industries/roofing-automation" class="block text-base font-medium text-gray-600">Roofing & Trades</a>
                    <a href="/industries/dental-automation" class="block text-base font-medium text-gray-600">Dental Practices</a>
                    <a href="/industries/real-estate-ai" class="block text-base font-medium text-gray-600">Real Estate</a>
                    <a href="/industries/legal-automation" class="block text-base font-medium text-gray-600">Law Firms</a>
                </div>
            </div>

            <div class="pt-4">
                <button @click="mobileMenuOpen = false; $dispatch('open-modal')" class="w-full bg-slate-900 text-white text-lg py-4 rounded-xl font-bold shadow-lg">
                    Start Project
                </button>
            </div>
       </div>
  </div>
</header>

<script>
  const header = document.getElementById('main-header');
  
  window.addEventListener('scroll', () => {
    if (window.scrollY > 20) {
      // Scrolled State
      header.classList.add('bg-white/90', 'backdrop-blur-md', 'border-gray-200', 'shadow-sm');
      header.classList.remove('border-transparent');
    } else {
      // Top State
      header.classList.remove('bg-white/90', 'backdrop-blur-md', 'border-gray-200', 'shadow-sm');
      header.classList.add('border-transparent');
    }
  });
</script>